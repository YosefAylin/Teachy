<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <title>My Schedule - Teachy</title>
    <link rel="stylesheet" th:href="@{/css/modern-style.css}" />
    <style>
        .calendar-container {
            max-width: 1000px;
            margin: 0 auto;
            background: rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 20px;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            color: white;
        }

        .calendar-nav {
            display: flex;
            gap: 10px;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
            background: rgba(255,255,255,0.2);
            border-radius: 8px;
            overflow: hidden;
        }

        .calendar-day-header {
            background: rgba(99, 102, 241, 0.8);
            color: white;
            padding: 10px;
            text-align: center;
            font-weight: bold;
        }

        .calendar-day {
            background: rgba(255,255,255,0.05);
            min-height: 120px;
            padding: 8px;
            position: relative;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .calendar-day.other-month {
            background: rgba(255,255,255,0.02);
            color: rgba(255,255,255,0.4);
        }

        .calendar-day.today {
            background: rgba(99, 102, 241, 0.2);
            border: 2px solid var(--education-purple);
        }

        .day-number {
            font-weight: bold;
            margin-bottom: 5px;
            color: white;
        }

        .lesson-item {
            background: rgba(16, 185, 129, 0.8);
            color: white;
            padding: 2px 6px;
            margin: 2px 0;
            border-radius: 4px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .lesson-item:hover {
            background: rgba(16, 185, 129, 1);
            transform: scale(1.02);
        }

        .lesson-item.pending {
            background: rgba(245, 158, 11, 0.8);
        }

        .lesson-item.completed {
            background: rgba(107, 114, 128, 0.8);
        }

        .lesson-time {
            font-weight: bold;
        }
    </style></head>
<body>
<div class="education-bg"></div>
<div class="container">
    <div class="form-container">
        <h1 class="form-title">ðŸ“… My Learning Schedule</h1>

        <div class="calendar-container">
            <!-- Calendar Header -->
            <div class="calendar-header">
                <div class="calendar-nav">
                    <a th:href="@{/student/schedule(year=${currentMonth == 1 ? currentYear - 1 : currentYear}, month=${currentMonth == 1 ? 12 : currentMonth - 1})}"
                       class="btn btn-secondary btn-sm">â€¹ Previous</a>
                </div>

                <h2 th:text="${#strings.capitalize(monthName)} + ' ' + ${currentYear}">Month Year</h2>

                <div class="calendar-nav">
                    <a th:href="@{/student/schedule(year=${currentMonth == 12 ? currentYear + 1 : currentYear}, month=${currentMonth == 12 ? 1 : currentMonth + 1})}"
                       class="btn btn-secondary btn-sm">Next â€º</a>
                </div>
            </div>

            <!-- Calendar Grid -->
            <div class="calendar-grid">
                <!-- Day Headers -->
                <div class="calendar-day-header">Sun</div>
                <div class="calendar-day-header">Mon</div>
                <div class="calendar-day-header">Tue</div>
                <div class="calendar-day-header">Wed</div>
                <div class="calendar-day-header">Thu</div>
                <div class="calendar-day-header">Fri</div>
                <div class="calendar-day-header">Sat</div>

                <!-- Empty cells for days before month starts -->
                <div th:each="i : ${#numbers.sequence(1, firstDayOfWeek)}" class="calendar-day other-month"></div>

                <!-- Days of the month -->
                <div th:each="day : ${#numbers.sequence(1, daysInMonth)}"
                     th:class="'calendar-day' + (${day == #temporals.day(#temporals.createNow())} and ${currentMonth == #temporals.month(#temporals.createNow())} and ${currentYear == #temporals.year(#temporals.createNow())} ? ' today' : '')">

                    <div class="day-number" th:text="${day}">1</div>

                    <!-- Lessons for this day -->
                    <div th:each="schedule : ${schedules}"
                         th:if="${#temporals.day(schedule.scheduledTime) == day}">
                        <div th:class="'lesson-item ' + ${#strings.toLowerCase(schedule.status)}"
                             th:title="${schedule.lesson?.description + ' with ' + schedule.teacher?.username}">
                            <div class="lesson-time" th:text="${#temporals.format(schedule.scheduledTime, 'HH:mm')}">09:00</div>
                            <div th:text="${#strings.abbreviate(schedule.teacher?.username, 8)}">Student</div>
                        </div>
                    </div>
                </div>

                <!-- Fill remaining cells -->
                <div th:each="i : ${#numbers.sequence(1, 42 - daysInMonth - firstDayOfWeek)}" class="calendar-day other-month"></div>
            </div>

            <!-- Legend -->
            <div class="mt-16" style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                <div style="display: flex; align-items: center; gap: 5px;">
                    <div class="lesson-item" style="width: 15px; height: 15px; margin: 0;"></div>
                    <span style="color: white; font-size: 12px;">Scheduled</span>
                </div>
                <div style="display: flex; align-items: center; gap: 5px;">
                    <div class="lesson-item pending" style="width: 15px; height: 15px; margin: 0;"></div>
                    <span style="color: white; font-size: 12px;">Pending</span>
                </div>
                <div style="display: flex; align-items: center; gap: 5px;">
                    <div class="lesson-item completed" style="width: 15px; height: 15px; margin: 0;"></div>
                    <span style="color: white; font-size: 12px;">Completed</span>
                </div>
            </div>
        </div>

        <div class="button-group mt-24">
            <a th:href="@{/student/home}" class="btn btn-secondary">Back to Dashboard</a>
            <a th:href="@{/student/schedule}" class="btn btn-primary">Current Month</a>
        </div>
    </div>
</div>
</body>
</html>